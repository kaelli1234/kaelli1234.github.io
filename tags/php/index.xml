<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>php on Kael Li</title>
    <link>/tags/php/</link>
    <description>Recent content in php on Kael Li</description>
    <generator>Hugo -- gohugo.io</generator>
    <copyright>&lt;a href=&#34;https://creativecommons.org/licenses/by-nc/4.0/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;CC BY-NC 4.0&lt;/a&gt;</copyright>
    <lastBuildDate>Thu, 18 Jan 2018 00:00:00 +0000</lastBuildDate>
    
	<atom:link href="/tags/php/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>PHP7.2 AESåŠ è§£å¯†</title>
      <link>/posts/2018/01/18/php72-aes/</link>
      <pubDate>Thu, 18 Jan 2018 00:00:00 +0000</pubDate>
      
      <guid>/posts/2018/01/18/php72-aes/</guid>
      <description> ç”±äºMcryptåº“ä»PHP 7.1.0 å¼€å§‹åºŸå¼ƒï¼›è‡ª PHP 7.2.0 èµ·ï¼Œä¼šç§»åˆ° PECLã€‚
 æ‰€ä»¥ä¹‹å‰ä½¿ç”¨PHP AESåŠ è§£å¯†çš„ç›¸å…³å‡½æ•°ï¼ˆmcrypt_encryptã€mcrypt_decrypt&amp;hellip;ï¼‰åœ¨PHP7.1+ä¸­éƒ½å·²ç»åºŸé™¤äº†ï¼Œæ–°ç‰ˆPHPä¸­é€šè¿‡OpenSSLåº“çš„ç›¸å…³æ–¹æ³•æ¥å®ç°AESç­‰åŠ è§£å¯†ã€‚
 openssl_encrypt openssl_decrypt
 å…¶å®æ‰‹å†Œä¸Šçš„è¯´æ˜å·²ç»éå¸¸æ¸…æ¥šäº†ï¼Œä½†æ˜¯å‡½æ•°å£°æ˜ä¸­çš„optionså‚æ•°çš„è¯´æ˜è®©æˆ‘å¾ˆå›°æƒ‘ï¼Œç»è¿‡å®è·µåæ•´ç†ç»“è®ºå¦‚ä¸‹
    options value è¯´æ˜     NULL 0 è¿”å›base64ç¼–ç åçš„å­—ç¬¦ä¸²   OPENSSL_RAW_DATA 1 è¿”å›åŸå§‹å­—ç¬¦ä¸²   OPENSSL_ZERO_PADDING 2 ä¸å¡«å……å­—ç¬¦ä¸²ï¼ˆé»˜è®¤ä½¿ç”¨PKCS#7å¡«å……å­—ç¬¦ä¸²ï¼‰     æ‰€ä»¥ä¹‹å‰ç”¨mcrypt_encryptæ–¹æ³•åŠ å¯†å¾—åˆ°çš„å¯†æ–‡ï¼Œåœ¨æ–°ç‰ˆä¸­åªè¦ç”¨openssl_decryptæ–¹æ³•å¹¶ä¸”ä½¿ç”¨options=0æ¥è§£å¯†å³å¯ã€‚
å‚è€ƒ
 https://secure.php.net/manual/zh/function.openssl-encrypt.php#117208 https://secure.php.net/manual/zh/function.openssl-decrypt.php#119577  </description>
    </item>
    
    <item>
      <title>Lumenä¸­ä½¿ç”¨ValidatorMiddlewareä¸­é—´ä»¶å¤„ç†è¯·æ±‚å‚æ•°éªŒè¯</title>
      <link>/posts/2017/03/08/validator-middleware/</link>
      <pubDate>Wed, 08 Mar 2017 00:00:00 +0000</pubDate>
      
      <guid>/posts/2017/03/08/validator-middleware/</guid>
      <description>æœ¬æ¬¡æ–‡ç« çš„ç¼˜ç”±æ¥ä¹‹ä¸‹é¢è¿™æ®µä»£ç 
public function test() { $message = [ &amp;#39;object_id.required&amp;#39; =&amp;gt; ErrorCode::PARAM_MISS, ]; $validator = Validator::make($this-&amp;gt;request-&amp;gt;all(), [ &amp;#39;object_id&amp;#39; =&amp;gt; &amp;#39;required&amp;#39;, ], $message); if ($validator-&amp;gt;fails()) { ...error } ... } ä¸Šé¢è¿™ä¸ªåœºæ™¯åº”è¯¥åº”è¯¥å¤§å®¶éƒ½ä¸ä¼šé™Œç”Ÿï¼ŒéªŒè¯è¯·æ±‚å‚æ•°æ˜¯ä¸€ä¸ªéå¸¸åŸºç¡€çš„åœºæ™¯ï¼Œå½“éœ€è¦éªŒè¯çš„å‚æ•°è¾ƒå°‘æ—¶çœ‹ä¸Šå»ä¹Ÿè¿˜èƒ½å‹‰å¼ºæ¥å—ï¼Œä½†å¦‚æœæ¥å£æ¥æ”¶çš„å‚æ•°è¾ƒå¤šæ—¶å°±ä¼šå˜æˆè¿™æ ·ğŸ˜‚
 ï¼ˆå…¶å®è¿˜æœ‰10+ä¸ªå‚æ•°çš„å›¾ï¼Œè€ƒè™‘åˆ°å¯†é›†ææƒ§ç—‡æ‚£è€…çš„æ„Ÿå—æ²¡æœ‰å‘ğŸ™‚ï¼‰å¥½å§ï¼Œæ²¡åŠæ³•ã€‚è°è®©æˆ‘ä»¬è¿™ä¸ªæ¥å£æ¥æ”¶çš„å‚æ•°å¤šå‘¢ï¼æ€ä¹ˆåŠï¼Œæˆ‘ä¹Ÿå¾ˆæ— å¥ˆå‘€ï¼
æ€è€ƒï¼šçœŸçš„æ²¡æœ‰åŠæ³•å—ï¼Ÿæˆ‘reviewäº†æœ€è¿‘å†™çš„å‡ ä¸ªcontrollerï¼Œå‘ç°äº†ä¸€ä¸ªå…±åŒç‚¹ï¼šæ¯ä¸€ä¸ªæ¥å£è¯·æ±‚å¯¹åº”çš„å¤„ç†çš„æ–¹æ³•ä¸­ï¼Œç¬¬ä¸€æ®µéƒ½æ˜¯å¤„ç†å¯¹åº”çš„å‚æ•°éªŒè¯çš„é€»è¾‘ï¼Œè¿™æ®µé€»è¾‘é™¤äº†å¯¹åº”æ¥å£çš„éªŒè¯è§„åˆ™ä¸ä¸€æ ·ï¼Œå…¶ä»–éƒ½æ˜¯è°ƒç”¨ç›¸åŒçš„é€»è¾‘ã€‚å…¶å®éƒ½æ˜¯é‡å¤çš„ä»£ç ï¼æ€ä¹ˆæ ·å¯ä»¥æŠŠè¿™äº›ä»£ç ä¼˜åŒ–ä¸€ä¸‹å‘¢ï¼Ÿ
å¥½ï¼Œé€šè¿‡åˆ†æä¸Šé¢çš„é—®é¢˜ï¼Œæˆ‘çš„ç¬¬ä¸€ååº”æ˜¯å¼•ç”¨ä¸­é—´ä»¶æ¥ç»Ÿä¸€å¤„ç†è¿™éƒ¨åˆ†çš„é€»è¾‘ã€‚ç½‘ä¸Šæ‰¾äº†ä¸‹ç›¸å…³çš„å¤„ç†æ–¹å¼ï¼Œå¹¶ä¸”å‚è€ƒäº†ä¸‹Laravel FormRequestçš„å®ç°ï¼Œæˆ‘è®¾è®¡äº†ValidatorMiddlewareä¸­é—´ä»¶æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä»£ç å¦‚ä¸‹ã€‚
namespace App\Http\Middleware; use Closure; class ValidatorMiddleware { /** * Handle an incoming request. * * @param \Illuminate\Http\Request $request * @param \Closure $next * @return mixed */ public function handle($request, Closure $next) { list($controller, $method) = explode(&amp;#39;@&amp;#39;, $request-&amp;gt;route()[1][&amp;#39;uses&amp;#39;]); $class = str_replace(&amp;#39;Controller&amp;#39;, &amp;#39;Request&amp;#39;, $controller); if (class_exists($class)) { $messageRequest = new $class($request, $method); $messageRequest-&amp;gt;validate(); } return $next($request); } }/** Requestå¤„ç†åŸºç±» **/ namespace App\Http\Requests; use Illuminate\Http\Request; use App\Exceptions\ResponseException; use Validator; class BaseRequest { protected $input; protected $method; public function __construct(Request $request, String $method) { $this-&amp;gt;input = $request-&amp;gt;all(); $this-&amp;gt;method = $method; } public function rules() { return []; } public function messages() { return []; } public function validate() { $rules = array_get($this-&amp;gt;rules(), $this-&amp;gt;method, []); $messages = array_get($this-&amp;gt;messages(), $this-&amp;gt;method, []); $validator = Validator::make($this-&amp;gt;input, $rules, $messages); if ($validator-&amp;gt;fails()) { $err = $validator-&amp;gt;errors()-&amp;gt;all(); throw new ResponseException(head($err)); } return true; } } ä¸‹é¢ç»“åˆå®é™…çš„ä¾‹å­æ¥è®²è§£:</description>
    </item>
    
    <item>
      <title>phpé€šè¿‡å®šä¹‰JSON Schemaæ¥æ ¡éªŒå¯¹åº”JSONçš„æ ¼å¼æ•°æ®</title>
      <link>/posts/2017/03/01/json-schema-validate/</link>
      <pubDate>Wed, 01 Mar 2017 00:00:00 +0000</pubDate>
      
      <guid>/posts/2017/03/01/json-schema-validate/</guid>
      <description>æœ€è¿‘é¡¹ç›®ä¸­é‡åˆ°çš„éœ€æ±‚ï¼Œå¯¹äºæŸJSONç±»å‹çš„å­—æ®µï¼Œè¦åšéªŒè¯çš„æ ¼å¼æ ¡éªŒï¼Œå¹¶ä¸”æ ‡å‡ºé”™è¯¯çš„åœ°æ–¹ã€‚
æœ¬ç€ä¸è¦é‡å¤é€ è½®å­çš„åŸåˆ™ï¼Œåœ¨githubä¸Šæ‰¾åˆ°äº†è¿™ä¸ªé¡¹ç›®
 é€šè¿‡å®šä¹‰å›ºå®šæ ¼å¼çš„JSON Schemaæ¥éªŒè¯å¯¹åº”æ ¼å¼çš„æ•°æ®ã€‚
https://github.com/justinrainbow/json-schema
 å…·ä½“çš„ä½¿ç”¨æ–¹æ³•å°±ä¸å¤šè¯´å•¦ï¼Œé€šè¿‡composerå®‰è£…ï¼Œå‚ç…§ç¤ºä¾‹å°±å¥½ã€‚
ä¸»è¦è¯´ä¸€ä¸‹JSON Schemaæ–‡ä»¶çš„å®šä¹‰é—®é¢˜ï¼ŒğŸ‘‡ç»“åˆä¸€ä¸ªæ¯”è¾ƒå¤æ‚çš„ä¾‹å­æ¥è¯´ä¸€ä¸‹Schemaå„ä¸ªå‚æ•°çš„ä½œç”¨
{ &amp;#34;title&amp;#34;: &amp;#34;Product set&amp;#34;, &amp;#34;type&amp;#34;: &amp;#34;array&amp;#34;, //åŸæ•°æ®æ ¼å¼ä¸ºæ•°ç»„ &amp;#34;minItems&amp;#34;: 1, //æœ€å°‘1ä¸ªå…ƒç´  &amp;#34;maxItems&amp;#34;: 10, //æœ€å¤š10ä¸ªå…ƒç´  &amp;#34;uniqueItems&amp;#34;: true, //æ•°æ®é‡å¤åˆ¤æ–­ &amp;#34;items&amp;#34;: { &amp;#34;title&amp;#34;: &amp;#34;Product&amp;#34;, &amp;#34;type&amp;#34;: &amp;#34;object&amp;#34;, //æ•°ç»„å…ƒç´ çš„å€¼ä¸ºå¯¹è±¡ &amp;#34;properties&amp;#34;: { &amp;#34;id&amp;#34;: { &amp;#34;description&amp;#34;: &amp;#34;The unique identifier for a product&amp;#34;, //idå­—æ®µæè¿° &amp;#34;type&amp;#34;: &amp;#34;string&amp;#34;, //idçš„ç±»å‹ä¸ºstring &amp;#34;pattern&amp;#34;: &amp;#34;^(\\([0-9]{3}\\))?[0-9]{3}-[0-9]{4}$&amp;#34; //éªŒè¯idæ˜¯å¦ç¬¦åˆè¯¥æ­£åˆ™è¡¨è¾¾å¼çš„è§„åˆ™ }, &amp;#34;name&amp;#34;: { &amp;#34;type&amp;#34;: &amp;#34;string&amp;#34;, //nameçš„ç±»å‹ä¸ºstring &amp;#34;maxLength&amp;#34;: 10 //æœ€å¤§é•¿åº¦ä¸º10 }, &amp;#34;url&amp;#34;: { &amp;#34;type&amp;#34;: &amp;#34;string&amp;#34;, //urlçš„ç±»å‹ä¸ºstring &amp;#34;format&amp;#34;: &amp;#34;uri&amp;#34; //å¹¶ä¸”ç¬¦åˆURIè§„åˆ™ }, &amp;#34;price&amp;#34;: { &amp;#34;type&amp;#34;: &amp;#34;number&amp;#34;, //priceçš„ç±»å‹ä¸ºnumber &amp;#34;minimum&amp;#34;: 0, //æœ€å°å€¼ä¸º0 &amp;#34;exclusiveMinimum&amp;#34;: true //è¯¥å­—æ®µä¸ºtrueæ—¶éªŒè¯price&amp;gt;0,falseæ—¶éªŒè¯price&amp;gt;=0 }, &amp;#34;tags&amp;#34;: { &amp;#34;type&amp;#34;: &amp;#34;string&amp;#34;, //tagsçš„ç±»å‹ä¸ºstring &amp;#34;enum&amp;#34;: [ //å¹¶ä¸”å€¼ä¸ºenumä¸­ä¹‹ä¸€ &amp;#34;food&amp;#34;, &amp;#34;fruit&amp;#34;, &amp;#34;juice&amp;#34; ] } }, &amp;#34;additionalProperties&amp;#34;: false, //ä¸å…è®¸é™¤äº†items.</description>
    </item>
    
    <item>
      <title>åŸºäºLumenæ¡†æ¶æ„å»ºåŸºç¡€çš„Web APIæœåŠ¡</title>
      <link>/posts/2017/02/10/imooc-lumen-api/</link>
      <pubDate>Fri, 10 Feb 2017 00:00:00 +0000</pubDate>
      
      <guid>/posts/2017/02/10/imooc-lumen-api/</guid>
      <description>å·§åˆä¸‹è·Ÿæ…•è¯¾ç½‘æœ‰è¿‡åˆä½œï¼Œè™½ç„¶åæ¥å› ä¸ºä¸ªäººå·¥ä½œæ—¶é—´çš„å…³ç³»æ²¡æœ‰æ·±å…¥è¿›è¡Œä¸‹å»ï¼Œä½†æ˜¯ä¹Ÿç®—å€Ÿç€è¿™ä¸ªæœºä¼šé”»ç‚¼ä¸€ä¸‹è‡ªå·±ï¼Œæ¢³ç†äº†ä¸‹è‡ªå·±æ‰€æŒæ¡çš„çŸ¥è¯†ï¼Œåœ¨è¿™é‡Œè·Ÿå¤§å®¶åšä¸ªåˆ†äº«ï¼Œæ¬¢è¿å¤§å®¶æŒ‡æ•™ã€‚</description>
    </item>
    
    <item>
      <title>PHPæœ€ä½³å®è·µï¼Œè§„èŒƒï¼Œç›¸å…³èµ„æºæ•´ç†</title>
      <link>/posts/2017/01/03/php-doc/</link>
      <pubDate>Tue, 03 Jan 2017 00:00:00 +0000</pubDate>
      
      <guid>/posts/2017/01/03/php-doc/</guid>
      <description>æ ‡è®°æ•´ç†ä¸‹ä¹¦ç­¾
 PHP
 PHP æ‰‹å†Œ PHP The Right Way PHP-FIG PSRä¸­æ–‡ç‰ˆ  Laravel
 Laravel China Laravel çš„ä¸­å¤§å‹å°ˆæ¡ˆæ¶æ§‹ èƒ–èƒ–Modelæ¸›é‡çš„äº”å€‹æ–¹æ³•  Tools &amp;amp;&amp;amp; Docs
 å¯¹ REST çš„ç†è§£ Mastering Markdown Awesome Mac APIDOC ç®€æ˜ VIM ç»ƒçº§æ”»ç•¥   æŒç»­æ›´æ–°</description>
    </item>
    
    <item>
      <title>Lumenæ¡†æ¶åœ¨åŒä¸€åŸŸåå¤šåº”ç”¨ç¯å¢ƒä¸‹çš„éƒ¨ç½²é—®é¢˜</title>
      <link>/posts/2016/08/25/lumen-application/</link>
      <pubDate>Thu, 25 Aug 2016 00:00:00 +0000</pubDate>
      
      <guid>/posts/2016/08/25/lumen-application/</guid>
      <description> åœ¨åŒä¸€åŸŸåä¸‹éƒ¨ç½²å¤šä¸ªåº”ç”¨æ—¶ï¼Œä½¿ç”¨Lumenæ¡†æ¶é‡åˆ°çš„é—®é¢˜ å®˜æ–¹æ–‡æ¡£çš„æ¨èä¸€èˆ¬æ˜¯é€šè¿‡é…ç½®ç½‘ç«™çš„æ ¹ç›®å½•è‡³wwwroot/LUMEN/public/ã€‚å¦‚æœæœåŠ¡å™¨ä¸Šåªæœ‰Lumenä¸€ä¸ªåº”ç”¨æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œä½†æ˜¯å¦‚æœæœåŠ¡å™¨ä¸ŠåŒæ—¶éƒ¨ç½²äº†å¤šä¸ªåº”ç”¨ï¼Œæƒ³é€šè¿‡wwwrootçš„ç›¸å¯¹è·¯å¾„http://DOMAIN/lumen/public/æ¥è®¿é—®æ¡†æ¶urlæ—¶å°±ä¼šå‡ºç°NotFoundHttpExceptionçš„å¼‚å¸¸ã€‚
æ ¹æ®é”™è¯¯æç¤ºï¼Œå®šä½åˆ°æ–‡ä»¶LUMEN/vendor/laravel/lumen-framework/src/Concerns/RegistersExceptionHandlers.phpä¸­370è¡Œï¼š
æ¡†æ¶ä¸­çš„LUMEN/public/index.phpé»˜è®¤æ˜¯$app-&amp;gt;run();æ˜¯ä¸ä¼ $requestçš„ï¼Œå¯¹åº”è°ƒç”¨çš„æ–¹æ³•å¦‚ä¸‹ï¼š
å¯è§é€šè¿‡æ­¤æ–¹æ³•è·å–çš„pathï¼Œå¦‚æœå­˜åœ¨å¤šåº”ç”¨çš„æƒ…å†µä¸‹ï¼Œ$this-&amp;gt;routesè·å–æ˜¯é”™è¯¯çš„ã€‚
è§£å†³æ–¹æ³•å¦‚ä¸‹ï¼š ä¿®æ”¹LUMEN/public/index.phpä¸º
$request = Illuminate\Http\Request::capture(); $app-&amp;gt;run($request); å‚è€ƒ
 https://segmentfault.com/a/1190000002724037 https://segmentfault.com/a/1190000004460637 http://stackoverflow.com/questions/29728973/notfoundhttpexception-with-lumen  </description>
    </item>
    
    <item>
      <title>PHPä½¿ç”¨CURLè®¿é—®HTTPS</title>
      <link>/posts/2016/08/08/php-curl-https/</link>
      <pubDate>Mon, 08 Aug 2016 00:00:00 +0000</pubDate>
      
      <guid>/posts/2016/08/08/php-curl-https/</guid>
      <description>æœ€è¿‘æ–°ä¸Šçº¿çš„é¡¹ç›®å‡†å¤‡å‡çº§æœåŠ¡æ”¯æŒhttpsè®¿é—®ï¼Œè®°å½•ä¸‹ä½¿ç”¨curlæ–¹æ³•è®¿é—®httpsæ—¶é‡åˆ°çš„é—®é¢˜ã€‚
ç›´æ¥ä¸Šä»£ç :
function post($url, $param) { $ssl = substr($url, 0, 8) == &amp;#34;https://&amp;#34; ? true : false; $ch = curl_init(); curl_setopt($ch, CURLOPT_URL, $url); if ($ssl) { curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false); // ä¿¡ä»»ä»»ä½•è¯ä¹¦ curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, false); // æ£€æŸ¥è¯ä¹¦ä¸­æ˜¯å¦è®¾ç½®åŸŸå // $cacert = getcwd() . &amp;#39;/cacert.pem&amp;#39;; //CAæ ¹è¯ä¹¦ // curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, true); // åªä¿¡ä»»CAé¢å¸ƒçš„è¯ä¹¦ // curl_setopt($ch, CURLOPT_CAINFO, $cacert); // CAæ ¹è¯ä¹¦ï¼ˆç”¨æ¥éªŒè¯çš„ç½‘ç«™è¯ä¹¦æ˜¯å¦æ˜¯CAé¢å¸ƒï¼‰ // curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 2); // æ£€æŸ¥è¯ä¹¦ä¸­æ˜¯å¦è®¾ç½®åŸŸåï¼Œå¹¶ä¸”æ˜¯å¦ä¸æä¾›çš„ä¸»æœºååŒ¹é… } curl_setopt($ch, CURLOPT_RETURNTRANSFER, true); curl_setopt($ch, CURLOPT_POST, true); curl_setopt($ch, CURLOPT_POSTFIELDS, $param); $return = curl_exec($ch); curl_close($ch); return $return; } ç®€å•æ¥è¯´è®¿é—®httpsæ—¶ï¼Œåªè¦æŒ‡å®šCURLOPT_SSL_VERIFYPEERå’ŒCURLOPT_SSL_VERIFYHOSTä¸ºfalseå°±èƒ½æ”¯æŒè®¿é—®äº†ã€‚å½“ç„¶ä¹Ÿå¯ä»¥ä¸‹è½½å¯¹åº”çš„æ ¹è¯ä¹¦ï¼Œç„¶ååœ¨è¯·æ±‚ä¸­å¸¦ä¸Šè®¿é—®ä¹Ÿå¯ä»¥ã€‚</description>
    </item>
    
    <item>
      <title>Lumen / Laravel .env</title>
      <link>/posts/2016/07/20/lumen-env/</link>
      <pubDate>Wed, 20 Jul 2016 00:00:00 +0000</pubDate>
      
      <guid>/posts/2016/07/20/lumen-env/</guid>
      <description> æœ€è¿‘åœ¨ä½¿ç”¨Lumenæ¡†æ¶éƒ¨ç½²ä¸Šçº¿æ—¶é‡åˆ°çš„ä¸€ä¸ªé—®é¢˜ Lumen / Laravel ä¸­çš„.envæ–‡ä»¶é‡Œä¸€èˆ¬é…ç½®ç€å„ç§ç¯å¢ƒæ‰€å¯¹åº”çš„é…ç½®ï¼Œä¾‹å¦‚ï¼šdbï¼Œcacheç­‰é…ç½®ï¼Œå®˜æ–¹çš„æ¨èæ˜¯ç‰ˆæœ¬åº“ä¸­ä¿ç•™ä¸€ä¸ª.env.exampleï¼Œå„ä¸ªç¯å¢ƒcp .env.exampleçš„é…ç½®å¹¶é…ä¸Šå¯¹åº”ç¯å¢ƒçš„é…ç½®ç”Ÿæˆ.envæ–‡ä»¶ï¼Œå®Œæˆé¡¹ç›®çš„éƒ¨ç½²ã€‚
ä½†å®é™…åº”ç”¨ä¸­ä¼šé‡åˆ°ä¸€ä¸ªæ¯”è¾ƒå°´å°¬çš„é—®é¢˜æ˜¯ï¼šå¦‚æœæ–°å¢æˆ–ä¿®æ”¹äº†é…ç½®ï¼Œéœ€è¦æ‰‹åŠ¨åˆ°å¯¹åº”ç¯å¢ƒä¸Šå»æ”¹é…ç½®ï¼Œä¸€èˆ¬çš„æµ‹è¯•æˆ–è€…å¼€å‘ç¯å¢ƒè¿˜å¥½ï¼Œä½†æ˜¯å¯¹åº”çº¿ä¸Šç”Ÿäº§æˆ–è€…é¢„å‘å¸ƒç¯å¢ƒï¼Œä¸€èˆ¬æ˜¯ä¸å…è®¸æ‰‹åŠ¨ä¿®æ”¹æ–‡ä»¶çš„ã€‚è€Œä¸”ä¹Ÿæœ‰å¯èƒ½çº¿ä¸Šçš„æœºå™¨è¾ƒå¤šï¼Œæ‰‹åŠ¨ä¸€ä¸ªä¸ªå»æ“ä½œä¸æ–¹ä¾¿ä¹Ÿä¸å®‰å…¨ã€‚è€Œä¸”åƒç°åœ¨ä¸€èˆ¬ä¹Ÿéƒ½æ˜¯ä½¿ç”¨è‡ªåŠ¨åŒ–ä¸Šçº¿å·¥å…·ï¼Œæ‹‰ç‰ˆæœ¬åº“ä»£ç ç›´æ¥ä¸Šçº¿ï¼Œæ­¤æ—¶å®˜æ–¹æ¨èçš„åšæ³•å°±ä¸æ˜¯å¾ˆé€‚ç”¨äº†ã€‚
æ—¢ç„¶æ»¡è¶³ä¸äº†è‡ªå·±çš„éœ€æ±‚ï¼Œé‚£å°±ç¨å¾®æ”¹é€ ä¸€ä¸‹å§ã€‚ åˆæ­¥çš„æ€è·¯æ˜¯: æŠŠå„ä¸ªç¯å¢ƒçš„é…ç½®æ–‡ä»¶éƒ½æ”¾åˆ°ç‰ˆæœ¬åº“é‡Œï¼Œç„¶åä»£ç é‡Œåˆ¤æ–­å‡ºå„ä¸ªç¯å¢ƒï¼ŒåŠ è½½å¯¹åº”çš„ç¯å¢ƒé…ç½®ã€‚
é¦–å…ˆæˆ‘ä»¬æ¥çœ‹çœ‹lumenæ˜¯å¦‚ä½•è¿è¡Œçš„ï¼Œé€šè¿‡åˆ†ælumençš„å…¥å£æ–‡ä»¶LUMEN/public/idnex.phpï¼Œæˆ‘ä»¬çœ‹åˆ°å®ƒå¼•ç”¨äº† LUMEN/bootstrap/app.php è¿™ä¸ªæ–‡ä»¶ã€‚ ç„¶ååœ¨LUMEN/bootstrap/app.phpä¸­ï¼Œå®Œæˆäº†Dotenvç±»çš„åˆå§‹åŒ– é€šè¿‡æŸ¥çœ‹Dotenvç±»çš„æºç ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“æ„é€ å‡½æ•°çš„ä¿©ä¸ªå‚æ•°çš„å«ä¹‰
 .envæ–‡ä»¶æ‰€åœ¨çš„ç›®å½• æ–‡ä»¶å  äº†è§£äº†å¦‚ä¸Šçš„ä¿¡æ¯åï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹è‡ªå·±çš„æ”¹åŠ¨å•¦ã€‚ é¦–å…ˆåœ¨ç‰ˆæœ¬åº“é‡Œæ–°å»º
 .env.local .env.test .env.production  é€šè¿‡è·å¾—æœåŠ¡å™¨çš„hostnameæ¥å¾—åˆ°å¯¹åº”çš„ç¯å¢ƒï¼Œç„¶åloadå¯¹åº”çš„.envæ–‡ä»¶å°±å¥½äº†ã€‚
å‚è€ƒ
 http://developers.ph/laravel-framework/laravel-5/how-to-setup-multiple-environment-for-laravel-5-developers-way  </description>
    </item>
    
    <item>
      <title>Lumen CORS</title>
      <link>/posts/2016/06/30/lumen-cors/</link>
      <pubDate>Thu, 30 Jun 2016 00:00:00 +0000</pubDate>
      
      <guid>/posts/2016/06/30/lumen-cors/</guid>
      <description>ä½¿ç”¨Lumenæ¡†æ¶å¦‚ä½•è§£å†³è·¨åŸŸé—®é¢˜ è·¨åŸŸé—®é¢˜æƒ³å¿…æ˜¯æ¯ä¸ªä»äº‹webç›¸å…³å¼€å‘çš„åŒå­¦ç»å¸¸é‡åˆ°çš„é—®é¢˜ï¼Œç‰¹åˆ«æ˜¯ç°åœ¨è¶Šæ¥è¶Šå¤šçš„åº”ç”¨é‡‡ç”¨çš„å‰åç«¯åˆ†ç¦»çš„å¼€å‘æ¨¡å¼ï¼Œæ‰€ä»¥è§£å†³è·¨åŸŸé—®é¢˜æˆäº†å¤§å®¶å¿…ä¸å¯å°‘çš„ä¸€é¡¹æŠ€èƒ½ã€‚æœ€è¿‘åœ¨ä½¿ç”¨Lumenæ¡†æ¶å¼€å‘æ—¶ä¹Ÿé‡åˆ°äº†è¿™ä¸ªé—®é¢˜ã€‚
è¿›å…¥ä¸»é¢˜ä¹‹å‰æˆ‘ä»¬å…ˆæ¥ä¸ªé“ºå«ï¼Œé¦–å…ˆæˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯è·¨åŸŸï¼Œä»¥åŠä¸€äº›è§£å†³æ–¹æ¡ˆ è¿™æ˜¯é“ºå«
æœ‰å…´è¶£çš„åŒå­¦å¯ä»¥ä»”ç»†çœ‹çœ‹ï¼Œå…¶å®W3Cæ ‡å‡†çš„è§£å†³æ–¹æ¡ˆæ˜¯åªè¦åœ¨æœåŠ¡å™¨responseçš„å¤´éƒ¨å¸¦ä¸ŠAccess-Control-Allow-Originï¼šDOMAIN(å…è®¸è·¨åŸŸè®¿é—®çš„åŸŸåï¼Œ*ä»£è¡¨æ‰€æœ‰)ï¼Œä¸è¿‡éœ€è¦ä¸€æçš„æ˜¯è¯¥æ–¹æ¡ˆåªæ”¯æŒIE8åŠä»¥ä¸Šï¼Œä»¥åŠä¸€äº›ç°ä»£æµè§ˆå™¨(Fire Fox,Chrome,etc.)ã€‚è§£å†³è·¨åŸŸæ¯”è¾ƒå¸¸è§çš„è¿˜æœ‰ä½¿ç”¨jsonpï¼Œä½†è¿™ä¸æ˜¯æœ¬æ–‡é‡ç‚¹ï¼Œè¿™é‡Œå°±ä¸å…·ä½“å±•å¼€äº†ã€‚
å¥½äº†ï¼Œä¸Šé¢å•°å—¦äº†é‚£ä¹ˆå¤šï¼Œä¸‹é¢è¿›å…¥ä¸»é¢˜ï¼Œé‚£ä¹ˆåœ¨Lumenæ¡†æ¶ä¸­ï¼Œæˆ‘ä»¬æ€ä¹ˆè§£å†³è·¨åŸŸé—®é¢˜å‘¢? è¿™è¾¹ä¸»è¦å‚è€ƒäº†è¿™é‡Œè¯¥å¤§ç¥çš„æ–¹æ¡ˆã€‚ é€šè¿‡è¿ç”¨æ¡†æ¶çš„Middlewareå’ŒServiceProvideræ¥è§£å†³è·¨åŸŸé—®é¢˜ã€‚
æ–°å¢ä¸­é—´ä»¶ï¼ŒLUMEN/app/Http/Middleware/CorsMiddleware.php
namespace App\Http\Middleware; use Closure; class CorsMiddleware { /** * Handle an incoming request. * * @param \Illuminate\Http\Request $request * @param \Closure $next * @return mixed */ public function handle($request, Closure $next) { $response = $next($request); $response-&amp;gt;header(&amp;#39;Access-Control-Allow-Methods&amp;#39;, &amp;#39;HEAD, GET, POST, PUT, PATCH, DELETE&amp;#39;); $response-&amp;gt;header(&amp;#39;Access-Control-Allow-Headers&amp;#39;, $request-&amp;gt;header(&amp;#39;Access-Control-Request-Headers&amp;#39;)); $response-&amp;gt;header(&amp;#39;Access-Control-Allow-Origin&amp;#39;, &amp;#39;*&amp;#39;); return $response; } } å®šä¹‰ServiceProviderï¼ŒLUMEN/app/Providers/CatchAllOptionsRequestsProvider.php
namespace App\Providers; use Illuminate\Support\ServiceProvider; /** * If the incoming request is an OPTIONS request * we will register a handler for the requested route */ class CatchAllOptionsRequestsProvider extends ServiceProvider { public function register() { $request = app(&amp;#39;request&amp;#39;); if ($request-&amp;gt;isMethod(&amp;#39;OPTIONS&amp;#39;)) { app()-&amp;gt;options($request-&amp;gt;path(), function() { return response(&amp;#39;&amp;#39;, 200)-&amp;gt;header(&amp;#39;Access-Control-Allow-Origin&amp;#39;, &amp;#39;*&amp;#39;); }); } } } åœ¨LUMEN/bootstrap/app.</description>
    </item>
    
    <item>
      <title>php5.6 curl ä¸Šä¼ æ–‡ä»¶å¤±è´¥</title>
      <link>/posts/2016/04/05/php-curlfile/</link>
      <pubDate>Tue, 05 Apr 2016 00:00:00 +0000</pubDate>
      
      <guid>/posts/2016/04/05/php-curlfile/</guid>
      <description>php5.6 CURLFile æ–°é¡¹ç›®ä¸­è¦å®Œæˆä¸€ä¸ªä¸Šä¼ æ–‡ä»¶çš„æ¥å£ï¼Œè¦å†™ä¸ªè‡ªæµ‹æ¥å£æ—¶é‡åˆ°çš„å‘ã€‚ã€‚ã€‚
ä¹‹å‰php5.4ç‰ˆæœ¬æ—¶curlä¸­ç›´æ¥é€šè¿‡@ç¬¦å·+æ–‡ä»¶è·¯å¾„ï¼Œåˆ™curlè‡ªåŠ¨ä¼šæŠŠæ–‡ä»¶è§£æä¸Šä¼ ï¼Œåç«¯é€šè¿‡$_FILESå˜é‡æ‹¿åˆ°ï¼Œä½†åœ¨å†™è‡ªæµ‹è„šæœ¬æ—¶æ­»æ´»æ²¡ååº”ã€‚ã€‚ã€‚çº ç»“äº†åŠå¤©æ‰åœ¨ stackoverflow æ‰¾åˆ°ç­”æ¡ˆã€‚
åŸæ¥æ–°ç‰ˆphpä¸­CURLOPT_SAFE_UPLOADå‚æ•°é»˜è®¤å·²ç»æ˜¯trueäº†ï¼Œæ‰€ä»¥ä¸æ”¯æŒ@è¿™æ ·ï¼ˆä¸å®‰å…¨ï¼‰çš„å†™æ³•ï¼Œè€Œæ˜¯é€šè¿‡CURLFileç±»æ¥å®Œæˆæ¨¡æ‹Ÿæ–‡ä»¶ä¸Šä¼ ã€‚ä»£ç å¦‚ä¸‹:
if ((version_compare(PHP_VERSION, &amp;#39;5.5&amp;#39;) &amp;gt;= 0)) { $aPost[&amp;#39;file&amp;#39;] = new CURLFile($localFile); curl_setopt($ch, CURLOPT_SAFE_UPLOAD, true); } else { $aPost[&amp;#39;file&amp;#39;] = &amp;#34;@&amp;#34;.$localFile; } $ch = curl_init(); curl_setopt($ch, CURLOPT_URL, $apiurl); curl_setopt($ch, CURLOPT_TIMEOUT, 120); curl_setopt($ch, CURLOPT_BUFFERSIZE, 128); curl_setopt($ch, CURLOPT_POSTFIELDS, $aPost); curl_setopt($ch, CURLOPT_RETURNTRANSFER, true); $sResponse = curl_exec ($ch); å½“ç„¶äº†ï¼Œå¦‚æœä¸æƒ³ä½¿ç”¨CURLFileæ–¹æ³•ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œæ‰‹åŠ¨è®¾ç½®CURLOPT_SAFE_UPLOADä¸ºfalseåï¼Œ@+æ–‡ä»¶åˆèƒ½æ”¯æŒäº†ï¼ˆä¸€èˆ¬phpç‰ˆæœ¬å‡çº§å…¼å®¹å¤„ç†é‡‡ç”¨æ­¤æ–¹å¼æ”¹åŠ¨æˆæœ¬è¾ƒå°ï¼‰</description>
    </item>
    
  </channel>
</rss>